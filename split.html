<!DOCTYPE html>
<html>
<header>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
</header>
<style>
    .container {
        margin: 10px !important;
    }

    h1 {
        font-size: 40px;
    }

    body {
        background-color: lightgreen;
    }

    #bet {
        background-color: green;
        color: yellow;
    }

    #placeBet {
        color: red;
    }

    #yourHand {
        font-size: 100px;
    }

    #dealerHand {
        font-size: 100px;
    }

    #text {
        font-size: 15px;
    }
</style>

<body>
    <div class="container">
        <h1>
            Blackjack
        </h1>
        <p>
            You have $<span id="money"></span>. Bet min: $2 Bet max: $500
        </p>
        <label> How much would you like to bet? <br> $
            <input type="number" id="bet" />
        </label>
        <button id="placeBet">
            Place Bet
        </button>
        <p id="yourBet"></p>

        <div>
            <div class="container mt-4">

                <div class="col-6">
                    <label id="text">
                        Your Hand:
                    </label>
                </div>
                <div id="yourHand" class="mt-3"></div>

                <div class="col-6 text-end">
                    <label id="text">
                        Dealer's Hand:
                    </label>
                </div>


                <div id="dealerHand" class="mt-3"></div>
            </div>
        </div>

        <br>
        <button id="hit" onClick="hit();">
            Hit
        </button>
        <button id="stand" onClick="stand()">
            Stand
        </button>
        <button id="double" onClick="double()">
            Double Down
        </button>
        <button id="split" onClick="split()">
            Split
        </button>
    </div>
</body>

<script>
    let money = 1000;
    let yourHand = [];
    let dealerHand = [];
    let bet = 0;
    let dealerPoints = 0;
    let timesSplit = 1;
    let handOrder = 1;
    let liveHands = [];
    document.getElementById("placeBet").disabled = false;
    document.getElementById("hit").disabled = true;
    document.getElementById("stand").disabled = true;
    document.getElementById("double").disabled = true;
    document.getElementById("split").disabled = true;
    document.getElementById("money").innerHTML = money;
    document.getElementById("placeBet").addEventListener("click", drawCards);
    let deck = [
        { card: 'ğŸ‚¡ ', point: 1, additionalpoint: 10 },
        { card: 'ğŸƒ‘ ', point: 1, additionalpoint: 10 },
        { card: 'ğŸ‚± ', point: 1, additionalpoint: 10 },
        { card: 'ğŸƒ ', point: 1, additionalpoint: 10 },
        { card: 'ğŸ‚¢ ', point: 2, additionalpoint: 0 },
        { card: 'ğŸ‚² ', point: 2, additionalpoint: 0 },
        { card: 'ğŸƒ‚ ', point: 2, additionalpoint: 0 },
        { card: 'ğŸƒ’ ', point: 2, additionalpoint: 0 },
        { card: 'ğŸ‚£ ', point: 3, additionalpoint: 0 },
        { card: 'ğŸ‚³ ', point: 3, additionalpoint: 0 },
        { card: 'ğŸƒƒ ', point: 3, additionalpoint: 0 },
        { card: 'ğŸƒ“ ', point: 3, additionalpoint: 0 },
        { card: 'ğŸ‚¤ ', point: 4, additionalpoint: 0 },
        { card: 'ğŸ‚´ ', point: 4, additionalpoint: 0 },
        { card: 'ğŸƒ„ ', point: 4, additionalpoint: 0 },
        { card: 'ğŸƒ” ', point: 4, additionalpoint: 0 },
        { card: 'ğŸ‚¥ ', point: 5, additionalpoint: 0 },
        { card: 'ğŸ‚µ ', point: 5, additionalpoint: 0 },
        { card: 'ğŸƒ… ', point: 5, additionalpoint: 0 },
        { card: 'ğŸƒ• ', point: 5, additionalpoint: 0 },
        { card: 'ğŸ‚¦ ', point: 6, additionalpoint: 0 },
        { card: 'ğŸ‚¶ ', point: 6, additionalpoint: 0 },
        { card: 'ğŸƒ† ', point: 6, additionalpoint: 0 },
        { card: 'ğŸƒ– ', point: 6, additionalpoint: 0 },
        { card: 'ğŸ‚§ ', point: 7, additionalpoint: 0 },
        { card: 'ğŸ‚· ', point: 7, additionalpoint: 0 },
        { card: 'ğŸƒ‡ ', point: 7, additionalpoint: 0 },
        { card: 'ğŸƒ— ', point: 7, additionalpoint: 0 },
        { card: 'ğŸ‚¨ ', point: 8, additionalpoint: 0 },
        { card: 'ğŸ‚¸ ', point: 8, additionalpoint: 0 },
        { card: 'ğŸƒˆ ', point: 8, additionalpoint: 0 },
        { card: 'ğŸƒ˜ ', point: 8, additionalpoint: 0 },
        { card: 'ğŸ‚© ', point: 9, additionalpoint: 0 },
        { card: 'ğŸ‚¹ ', point: 9, additionalpoint: 0 },
        { card: 'ğŸƒ‰ ', point: 9, additionalpoint: 0 },
        { card: 'ğŸƒ™ ', point: 9, additionalpoint: 0 },
        { card: 'ğŸ‚ª ', point: 10, additionalpoint: 0 },
        { card: 'ğŸ‚º ', point: 10, additionalpoint: 0 },
        { card: 'ğŸƒŠ ', point: 10, additionalpoint: 0 },
        { card: 'ğŸƒš ', point: 10, additionalpoint: 0 },
        { card: 'ğŸ‚« ', point: 10, additionalpoint: 0 },
        { card: 'ğŸ‚» ', point: 10, additionalpoint: 0 },
        { card: 'ğŸƒ‹ ', point: 10, additionalpoint: 0 },
        { card: 'ğŸƒ› ', point: 10, additionalpoint: 0 },
        { card: 'ğŸ‚­ ', point: 10, additionalpoint: 0 },
        { card: 'ğŸ‚½ ', point: 10, additionalpoint: 0 },
        { card: 'ğŸƒ ', point: 10, additionalpoint: 0 },
        { card: 'ğŸƒ ', point: 10, additionalpoint: 0 },
        { card: 'ğŸ‚® ', point: 10, additionalpoint: 0 },
        { card: 'ğŸ‚¾ ', point: 10, additionalpoint: 0 },
        { card: 'ğŸƒ ', point: 10, additionalpoint: 0 },
        { card: 'ğŸƒ ', point: 10, additionalpoint: 0 }];
    function isValidMoneyAmount(value) {
        return /^-?\d+(\.\d{1,2})?$/.test(value.toString());
    }

    function drawCards() {
        bet = Number(document.getElementById("bet").value);
        if (bet < 2 || bet > 500 || isValidMoneyAmount(bet) == false) {
            document.getElementById("yourBet").innerHTML =
                (bet < 2) ? "Your bet is below the bet minimum. Please try again" : (bet > 500) ? "Your bet is above the bet maximum. Please try again" : "Your bet is invalid. Please try again";
        } else {
            document.getElementById("placeBet").disabled = true;
            placeBet();
        }
    }

    function placeBet() {
        yourHand = [];
        dealerHand = [];
        dealerPoints = 0;
        bet = Number(document.getElementById("bet").value);
        document.getElementById("placeBet").disabled = true;
        document.getElementById("yourBet").innerHTML = "Your bet: $" + bet;
        if (deck.length < 11) {
            deck = [
                { card: 'ğŸ‚¡ ', point: 1, additionalpoint: 10 },
                { card: 'ğŸƒ‘ ', point: 1, additionalpoint: 10 },
                { card: 'ğŸ‚± ', point: 1, additionalpoint: 10 },
                { card: 'ğŸƒ ', point: 1, additionalpoint: 10 },
                { card: 'ğŸ‚¢ ', point: 2, additionalpoint: 0 },
                { card: 'ğŸ‚² ', point: 2, additionalpoint: 0 },
                { card: 'ğŸƒ‚ ', point: 2, additionalpoint: 0 },
                { card: 'ğŸƒ’ ', point: 2, additionalpoint: 0 },
                { card: 'ğŸ‚£ ', point: 3, additionalpoint: 0 },
                { card: 'ğŸ‚³ ', point: 3, additionalpoint: 0 },
                { card: 'ğŸƒƒ ', point: 3, additionalpoint: 0 },
                { card: 'ğŸƒ“ ', point: 3, additionalpoint: 0 },
                { card: 'ğŸ‚¤ ', point: 4, additionalpoint: 0 },
                { card: 'ğŸ‚´ ', point: 4, additionalpoint: 0 },
                { card: 'ğŸƒ„ ', point: 4, additionalpoint: 0 },
                { card: 'ğŸƒ” ', point: 4, additionalpoint: 0 },
                { card: 'ğŸ‚¥ ', point: 5, additionalpoint: 0 },
                { card: 'ğŸ‚µ ', point: 5, additionalpoint: 0 },
                { card: 'ğŸƒ… ', point: 5, additionalpoint: 0 },
                { card: 'ğŸƒ• ', point: 5, additionalpoint: 0 },
                { card: 'ğŸ‚¦ ', point: 6, additionalpoint: 0 },
                { card: 'ğŸ‚¶ ', point: 6, additionalpoint: 0 },
                { card: 'ğŸƒ† ', point: 6, additionalpoint: 0 },
                { card: 'ğŸƒ– ', point: 6, additionalpoint: 0 },
                { card: 'ğŸ‚§ ', point: 7, additionalpoint: 0 },
                { card: 'ğŸ‚· ', point: 7, additionalpoint: 0 },
                { card: 'ğŸƒ‡ ', point: 7, additionalpoint: 0 },
                { card: 'ğŸƒ— ', point: 7, additionalpoint: 0 },
                { card: 'ğŸ‚¨ ', point: 8, additionalpoint: 0 },
                { card: 'ğŸ‚¸ ', point: 8, additionalpoint: 0 },
                { card: 'ğŸƒˆ ', point: 8, additionalpoint: 0 },
                { card: 'ğŸƒ˜ ', point: 8, additionalpoint: 0 },
                { card: 'ğŸ‚© ', point: 9, additionalpoint: 0 },
                { card: 'ğŸ‚¹ ', point: 9, additionalpoint: 0 },
                { card: 'ğŸƒ‰ ', point: 9, additionalpoint: 0 },
                { card: 'ğŸƒ™ ', point: 9, additionalpoint: 0 },
                { card: 'ğŸ‚ª ', point: 10, additionalpoint: 0 },
                { card: 'ğŸ‚º ', point: 10, additionalpoint: 0 },
                { card: 'ğŸƒŠ ', point: 10, additionalpoint: 0 },
                { card: 'ğŸƒš ', point: 10, additionalpoint: 0 },
                { card: 'ğŸ‚« ', point: 10, additionalpoint: 0 },
                { card: 'ğŸ‚» ', point: 10, additionalpoint: 0 },
                { card: 'ğŸƒ‹ ', point: 10, additionalpoint: 0 },
                { card: 'ğŸƒ› ', point: 10, additionalpoint: 0 },
                { card: 'ğŸ‚­ ', point: 10, additionalpoint: 0 },
                { card: 'ğŸ‚½ ', point: 10, additionalpoint: 0 },
                { card: 'ğŸƒ ', point: 10, additionalpoint: 0 },
                { card: 'ğŸƒ ', point: 10, additionalpoint: 0 },
                { card: 'ğŸ‚® ', point: 10, additionalpoint: 0 },
                { card: 'ğŸ‚¾ ', point: 10, additionalpoint: 0 },
                { card: 'ğŸƒ ', point: 10, additionalpoint: 0 },
                { card: 'ğŸƒ ', point: 10, additionalpoint: 0 }];
        }
        drawCard(yourHand, 1);
        drawCard(yourHand, 1);
        drawCard(dealerHand, 1);
        drawCard(dealerHand, 1);
        liveHands = [1];
        document.getElementById("yourHand").innerHTML = yourHand[0].card + yourHand[1].card;
        document.getElementById("dealerHand").innerHTML = "ğŸ‚  " + dealerHand[0].card;
        if (calculateTotalPoints(yourHand) == 21 && calculateTotalPoints(dealerHand) == 21) {
            document.getElementById('dealerHand').innerHTML = dealerHand[1].card + dealerHand[0].card;
            refresh('Draw!', true);
            return;
        }
        if (calculateTotalPoints(yourHand) == 21) {
            money += Math.round(bet * 1.5);
            refresh('You Win!', true);
            return;
        }
        if (calculateTotalPoints(dealerHand) == 21) {
            document.getElementById('dealerHand').innerHTML = dealerHand[1].card + dealerHand[0].card;
            money -= bet;
            refresh('Dealer Wins!', true);
            return;
        }
        if (yourHand[0].point == yourHand[1].point) {
            document.getElementById("split").disabled = false;
        }
        else {
            document.getElementById("split").disabled = true;
        }
        document.getElementById("hit").disabled = false;
        document.getElementById("stand").disabled = false;
        document.getElementById("double").disabled = false;
    }

    function calculateTotalPoints(hand, split) {
        let totalPoints = 0;
        if (timesSplit === 1 || hand === dealerHand) {
            hand.forEach(x => {
                totalPoints += x.point;
            })
            hand.forEach(x => {
                if (totalPoints + x.additionalpoint > 21) {
                    return totalPoints;
                }
                else {
                    totalPoints += x.additionalpoint;
                }
            })
            return totalPoints;
        }
        else {
            const splitHand = hand.filter(item => item.handNo === split);
            let totalPoints = 0;
            splitHand.forEach(x => {
                totalPoints += x.point;
            })
            splitHand.forEach(x => {
                if (totalPoints + x.additionalpoint > 21) {
                    return totalPoints;
                }
                else {
                    totalPoints += x.additionalpoint;
                }
            })
            return totalPoints;

        }
    }

    function hit() {
        document.getElementById("double").disabled = true;
        document.getElementById("split").disabled = true;
        drawCard(yourHand, 1);
        yourHand[yourHand.length - 1].handNo = handOrder;
        if (handOrder === 1) {
            document.getElementById('yourHand').innerHTML += yourHand[yourHand.length - 1].card;
        }
        else {
            document.getElementById('yourHand' + handOrder).innerHTML += yourHand[yourHand.length - 1].card;
        }
        if (calculateTotalPoints(yourHand, handOrder) > 21) {
            if (handOrder === timesSplit) {
                document.getElementById('dealerHand').innerHTML = dealerHand[1].card + dealerHand[0].card;
            }
            money -= bet;
            const index = liveHands.indexOf(handOrder);
            if (index > -1) {
                liveHands.splice(index, 1);
            }
            refresh('You Busted!', true);
        }
    }

    function dealerHit() {
        drawCard(dealerHand, 1);
        document.getElementById('dealerHand').innerHTML += dealerHand[dealerHand.length - 1].card;
        dealerPoints = calculateTotalPoints(dealerHand);
        if (dealerPoints > 21) {
            money += bet * liveHands.length;
            refresh('Dealer Busted!', true);
            return;
        }
        return dealerPoints;
    }
    function stand() {
        if (handOrder === timesSplit) {
            document.getElementById('dealerHand').innerHTML = dealerHand[1].card + dealerHand[0].card;
            dealerPoints = calculateTotalPoints(dealerHand);
            let timesWon = 0;
            let timesLost = 0;
            let timesDrew = 0;
            while (dealerPoints < 17) {
                dealerHit();
                dealerPoints = calculateTotalPoints(dealerHand);
            }
            if (dealerPoints > 21) {
                return;
            }
            for (i = 1; i > timesSplit || i === timesSplit ; i++) {

                if (calculateTotalPoints(yourHand, i) > dealerPoints && liveHands.includes(i) === true) {
                    money += bet;
                    timesWon += 1;
                }
                return;
            }
            for (i = 1; i > timesSplit || i === timesSplit ; i++) {

                if (calculateTotalPoints(yourHand, i) == dealerPoints && liveHands.includes(i) === true) {
                    timesDrew += 1;
                }
                return;
            }
            for (i = 1; i > timesSplit || i === timesSplit ; i++) {

                if (calculateTotalPoints(yourHand, i) < dealerPoints && liveHands.includes(i) === true) {
                    money -= bet;
                    timesLost += 1;
                }
                return;
            }
            refresh("Hands won: " + timesWon + " Hands lost:" + timesLost + " Hands drew: " + timesDrew, true);
        }
        else {
            const x = document.getElementById("yourHand");
            x.style.color = "darkgray";
            const y = document.getElementById("yourHand" + (handOrder + 1));
            y.style.color = "black"
            handOrder += 1;
        }
    }
    function refresh(betResult, isFinished) {
        if (handOrder === timesSplit) {
            document.getElementById('yourBet').innerHTML = betResult;
            document.getElementById("money").innerHTML = money;
            document.getElementById("bet").value = "";
            document.getElementById("placeBet").disabled = !isFinished;
            document.getElementById("hit").disabled = isFinished;
            document.getElementById("stand").disabled = isFinished;
            document.getElementById("double").disabled = isFinished;
            document.getElementById("split").disabled = isFinished;
            timesSplit = 1;
            handOrder = 1;
            liveHands = [1];
        }
        else {
            document.getElementById("money").innerHTML = money;
            document.getElementById("yourBet").innerHTML = "Your bet: $" + bet + " x" + (timesSplit - handOrder);
            var x;
            if (handOrder === 1) {
                x = document.getElementById("yourHand");
            }
            else {
                x = document.getElementById("yourHand" + handOrder);
            }
            x.style.color = "darkgray";
            const y = document.getElementById("yourHand" + (handOrder + 1));
            y.style.color = "black"
            handOrder += 1;
        }
    }
    function double() {
        bet = bet * 2;
        hit();
        if (calculateTotalPoints(yourHand) < 22) {
            stand();
        }
    }
    function drawCard(hand, handNumber) {
        let randomCard = Math.floor(Math.random() * deck.length);
        hand.push(deck[randomCard]);
        deck.splice(randomCard, 1);
        hand[hand.length - 1].handNo = handNumber;
    }
    function split() {
        timesSplit += 1;
        document.getElementById("split").disabled = true;
        yourHand[0].handNo = timesSplit;
        createNewHand();
        sortCards(timesSplit - 1);
        document.getElementById("yourBet").innerHTML = "Your bet: $" + bet + " x" + timesSplit;
    }
    function createNewHand() {
        const newHand = document.createElement("div");
        const newCards = document.createTextNode(yourHand[0].card);
        newHand.appendChild(newCards);
        const currentHand = document.getElementById("yourHand");
        const parentNode = document.getElementsByClassName("col-6");
        currentHand.parentNode.insertBefore(newHand, currentHand.nextSibling);
        newHand.style.fontSize = "100px";
        newHand.style.color = "darkgray";
        newHand.classList.add('mt-3');
        newHand.id = "yourHand" + timesSplit;
        liveHands.push((liveHands.length + 1));
    }
    function sortCards(cardNumber) {
        const sortedHand = yourHand.filter(item => item.handNo === cardNumber);
        document.getElementById("yourHand").innerHTML = sortedHand[0].card;
    }

    //thanks g.
</script>

</html>